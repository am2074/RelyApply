


<% content_for :title do %>
 Company | Rely Apply
<% end %>
<%#Company Profile Show Header %>
<div class="panel panel-default" id="panelCompanyShow">
  <div class="panel-heading" id="panelCompanyShowHeader">
    <h1><strong><%= @company.name %></strong></h1>
  </div>
  <div class="panel-body">
      <div class="pull-left">
       <h3>
         <strong>Website:</strong>
           <%= link_to @company.website, "http://#{@company.website}" %>
       </h3>
      </div>
      <div class="text-center">
        <h3><strong>Responsiveness Rating:</strong> 
          <% if @company.reviews.size == 0 %> 
            There are currently no reviews
          <% else %>
            <%= number_to_percentage((Float(@company.reviews.where(satisfaction: "Highly satisfied. My expectations were far surpassed.").size + @company.reviews.where(satisfaction: "Average Satisfaction").size) /@company.reviews.count * 100), precision: 0) %> <span class="glyphicon glyphicon-thumbs-up"></span></p> 
          <% end %>
        </h3> 
      </div>    
<%# Edit Company Information Section %> 
<% if user_signed_in? %>
  <p>
    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#editCompanyDetails" aria-expanded="false" aria-controls="editCompanyDetails">
      Edit Company Information
    </button>
  </p>
  <div class="collapse" id="editCompanyDetails">
    <div class="card card-body">
      <p><I>*Edits must first be approved by RelyApply's admins*</I></p>
      <%= simple_form_for [@company, Request.new] do |f| %>
        <div class="form-inputs">
          <%= f.input :name_suggestion %>
          <%= f.input :website_suggestion %>
        </div>
    
        <div class="form-actions">
          <%= f.button :submit, "Submit", :class => "btn btn-primary", data: { confirm: "Is the information you provided correct?" } %>
        </div>
      <% end %>
    </div>
  </div>
<% else %>
    <div>
      <br />
      <p> You need to <%= link_to "Log in", new_user_session_path %> or <%= link_to "Sign up", new_user_registration_path %> to request for information changes on <%= @company.name%>'s profile </p>
    </div>
  <% end %>
</div>
</div>

        
<!-- Nav tabs -->
<ul class="nav nav-tabs" role="tablist">
  <li role="presentation" class="active"><a href="#overall" aria-controls="home" role="tab" data-toggle="tab">Overall</a></li>
  <li role="presentation"><a href="#last60" aria-controls="profile" role="tab" data-toggle="tab">Last 2 Months</a></li>
  <li role="presentation"><a href="#review-form" aria-controls="review-form" role="tab" data-toggle="tab">Add a Review</a></li>
  <li role="presentation"><a href="#post-review-form" aria-controls="review-form" role="tab" data-toggle="tab">Add a Post-Interview Review</a></li>
  <li role="presentation"><%= link_to 'Show Reviews', company_reviews_path(@company)%></li>
  <li role="presentation"><%= link_to 'Show Post-Interview Reviews', company_offers_path(@company)%></li>
</ul>

<!-- Tab panes -->
<div class="tab-content" id="statistics">
  <%# Overall Tab Pane %>
  <div role="tabpanel" class="tab-pane active" id="overall">
  
    <%# Review Section Part A: Review Size%>
    <h2>
      <% if @company.reviews.size == 0 %> 
        There are currently no reviews
      <% else %>
        <strong>Total Reviews: <%= @company.reviews.count %></strong>
      <% end %>
    </h2> 

    <%# Review Section Part B: Basic Statistics Section %>
    <div class="well" id="Summary">
      <h3><strong>Summary of Follow-up Response Times</strong></h3>
      <I>**Follow-ups include interview scheduling or rejections **</I>
      <h3><strong><%= @company.reviews.where(response_time: "1 week").size %> </strong> said around 1 week</h3>
      <h3><strong><%= @company.reviews.where(response_time: "2 weeks").size %></strong> said around 2 weeks</h3>
      <h3><strong><%= @company.reviews.where(response_time: "3 weeks").size %></strong> said around 3 weeks</h3>
      <h3><strong><%= @company.reviews.where(response_time: "Greater than 4 weeks").size %></strong> said around 4 weeks or greater</h3>
    </div>
    <hr>
  </div>

  <%# Last 2 Months Tab Pane %>
  <div role="tabpanel" class="tab-pane" id="last60">      
    <%# Last 2 Months Section Part B: Review Size%>
    <h2>
      <% if @company.reviews.size == 0 %> 
      There are currently no reviews
      <% else %>
      <strong>Reviews from Last 2 Months: <%= @company.reviews.count %></strong>
      <% end %>
    </h2> 
    <%# Last 2 Months Section Part B: Basic Statistics Section %>
    <div class="well" id="Summary">
      <h3><strong>Summary of Follow-up Response Times</strong></h3>
      <I>**Follow-ups include interview scheduling or rejections **</I>
      <h3><strong><%= @company.reviews.where(response_time: "1 week").size %> </strong> said around 1 week</h3>
      <h3><strong><%= @company.reviews.where(response_time: "2 weeks").size %></strong> said around 2 weeks</h3>
      <h3><strong><%= @company.reviews.where(response_time: "3 weeks").size %></strong> said around 3 weeks</h3>
      <h3><strong><%= @company.reviews.where(response_time: "Greater than 4 weeks").size %></strong> said around 4 weeks or greater</h3>
    </div>
    <hr>
  </div>

  <%# Add A Review Tab %>
  <div role="tabpanel" class="tab-pane" id="review-form">
     <%= render 'company_review_form', company: @company %>
  </div>



   <%# Add A Review Tab %>
  <div role="tabpanel" class="tab-pane" id="post-review-form">
     <%= render 'company_post_review_form', company: @company %>
  </div>
</div>
