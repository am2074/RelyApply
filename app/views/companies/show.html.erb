 <% content_for :title do %>
 Company | Rely Apply
<% end %>


<div class="container emp-profile">
  <form method="post">
      <div class="row">
          <!--
            <div class="col-md-4">
               Company Profile: Profile Picture 
                <div class="profile-img">
                    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcS52y5aInsxSm31CvHOFHWujqUx_wWTS9iM6s7BAm21oEN_RiGoog" alt=""/>
                    <div class="file btn btn-lg btn-primary">
                        Change Photo
                        <input type="file" name="file"/>
                    </div>
                </div>
            </div>
             -->
             <!-- Company Profile: Name, Website, Rating --> 
        <div class="col-md-6">
          <div class="profile-head">
                        <h2>
                            <%= @company.name %>
                            <%= @company.reviews.select("response_time, response_time_count").group(:response_time) %>

                        </h2>
                        <h6>
                            <%= link_to @company.website, "http://#{@company.website}" %>
                        </h6>
                         
                            <p>
                              <button class="btn btn-secondary btn-sm" type="button" data-toggle="collapse" data-target="#editCompanyDetails" aria-expanded="false" aria-controls="editCompanyDetails">
                                Edit Company Information
                              </button>
                            </p>
                           <% if user_signed_in? %>
                            <div class="collapse" id="editCompanyDetails">
                              <div class="card card-body" id="editCompanyDetailsCard">
                                <p><I>*Edits must first be approved by RelyApply's admins*</I></p>
                                <%= simple_form_for [@company, Request.new] do |f| %>
                                  <div class="row">
                                    <div class="col-md-4">
                                    <%= f.label :name_suggestion do %>
                                      Name
                                    <% end %>
                                    </div>
                                    <div class="col-md-3">
                                      <%= f.text_field :name_suggestion %>
                                    </div>
                                  </div>

                                  <div class="row">
                                    <div class="col-md-4">
                                      <%= f.label :website_suggestion do %>
                                        Site
                                      <% end %>
                                    </div>
                                    <div class="col-md-4">
                                      <%= f.text_field :website_suggestion %>
                                    </div>
                                  </div>
                              
                                  <div class="form-actions" align="center">
                                    <%= f.button :submit, "Submit", :class => "btn btn-primary", data: { confirm: "Is the information you provided correct?" } %>
                                  </div>
                                <% end %>
                              </div>
                            </div>
                          <% else %>
                              <div>
                                <p> You need to <%= link_to "Log in", new_user_session_path %> or <%= link_to "Sign up", new_user_registration_path %> to request for information changes on <%= @company.name%>'s profile </p>
                              </div>
                            <% end %>
          </div>
        </div>
            <div  class= "col-md-6">
              <h3 class="proile-rating">
                <span class="good-review-score-show" id="responseScoreShowPage">      
                              Response Rating : 
                                <% if @company.reviews.size == 0 %> 
                                  <i class="far fa-times-circle icon-4x"></i>
                                <% else %>
                                  <%= number_to_percentage((Float(@company.reviews.where(satisfaction: "Positive").size + @company.offers.where(satisfaction:"Positive").size)/(@company.reviews.count + @company.offers.count) * 100),precision: 0) %> 
                                <% end %>
                </span>                
              </h3>
            </div>
            <!-- Edit Company Profile Button 
            <div class="col-md-3 float-right">
                <input type="submit" class="profile-edit-btn" name="btnAddMore" value="Edit Profile"/>
            </div> -->
        </div>
        <div class="row">
            <div class="col-md-12">
              <!--Company Navbar --> 
              <div class="profile-head">
              <!--Company Navbar Headers --> 
               <ul class="nav nav-tabs" id="navbarCompanyShow" role="tablist">
                        <li class="nav-item">
                            <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Overall</a>
                        </li>
                        <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Submit Response Time</a>
                          <div class="dropdown-menu">
                            <p> <%= link_to ' • Application', new_company_review_path(@company), :id=>"dropdownItem" %></p>
                            <p><%= link_to ' • Post-Interview', new_company_offer_path(@company), :id=>"dropdownItem" %></p>
                          </div>
                        </li>
                        <li class="nav-item dropdown">
                          <a class="nav-link dropdown-toggle" data-toggle="dropdown" href="#" role="button" aria-haspopup="true" aria-expanded="false">Reviews</a>
                          <div class="dropdown-menu">
                            <p><%= link_to '• Application', company_reviews_path(@company), :id=>"dropdownItem"%></p>
                            <p><%= link_to '• Post-Interview', company_offers_path(@company), :id=>"dropdownItem"%></p>
                          </div>
                        </li>
                    </ul>
              </div>
               <!--Company Navbar Tab Contents --> 
                <div class="tab-content profile-tab" id="myTabContent">
                    <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                      <!-- Response Times Tables -->    
                      <!-- Table A: Response Times Tables -->    
                      <div class="col-md-4">
                          <I>*Application Response Times are estimated</I>
                      </div>
                        <table class="table">
                          <thead class="bg-primary">
                            <th>Application Response Time (~)</th>
                            <th># Reported</th>
                          </thead>
                          <tbody>
                            <tr>
                              <td>1 week</td>
                              <td><%= @company.reviews.where(response_time: "1 week").size %></td>
                            </tr>
                              <tr>
                              <td>2 weeks</td>
                              <td><%= @company.reviews.where(response_time: "2 weeks").size %></td>
                            </tr>
                            <tr>
                              <td>3 weeks</td>
                              <td><%= @company.reviews.where(response_time: "3 weeks").size %></td>
                            </tr>
                             <tr>
                              <td>4 weeks</td>
                              <td><%= @company.reviews.where(response_time: "4 weeks").size %></td>
                            </tr>
                            <tr>
                              <td>Greater than 4 weeks</td>
                              <td><%= @company.reviews.where(response_time: "Greater than 4 weeks").size %></td>
                            </tr>
                             
                          </tbody>
                        </table>
                      <!-- Table B: Post-Interview Response Times -->  
                        <div class="col-md-6">
                          <I>*Post-Interview Response Times are estimated</I>
                        </div>
                        <table class="table">
                          <thead class="bg-secondary">
                            <th>Post-Interview Response Time (~)</th>
                            <th># Reported</th>
                          </thead>
                          <tbody>
                            <tr>
                              <td>1-3 days</td>
                              <td><%= @company.offers.where(response_time: "1-3 days").size %></td>
                            </tr>
                            <tr>
                              <td>4-6 days</td>
                              <td><%= @company.offers.where(response_time: "4-6 days").size %></td>
                            </tr>
                            <tr>
                              <td>1 week</td>
                              <td><%= @company.offers.where(response_time: "1 week").size %></td>
                            </tr>
                              <tr>
                              <td>2 weeks</td>
                              <td><%= @company.offers.where(response_time: "2 weeks").size %></td>
                            </tr>
                            <tr>
                              <td>3 weeks</td>
                              <td><%= @company.offers.where(response_time: "3 weeks").size %></td>
                            </tr>
                            <tr>
                              <td>4 weeks</td>
                              <td><%= @company.offers.where(response_time: "4 weeks").size %></td>
                            </tr>
                            <tr>
                              <td>4 weeks or greater</td>
                              <td><%= @company.offers.where(response_time: "Greater than 4 weeks").size %></td>
                            </tr>                                   
                          </tbody>
                        </table>
                    </div>
      
                   
                    </div>
                </div>
            </div>
        </div>
    </form>           
</div>

















































     